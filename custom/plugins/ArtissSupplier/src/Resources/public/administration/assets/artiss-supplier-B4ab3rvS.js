const l={general:{mainMenuLabel:"ARTISS"}},n={general:{mainMenuItemGeneral:"Lieferanten",description:"Lieferanten verwalten"},list:{buttonAddSupplier:"Lieferant hinzufügen",columnName:"Name"},detail:{cardTitleGeneral:"Allgemeine Informationen",labelName:"Name",placeholderName:"Lieferantenname eingeben...",labelManufacturers:"Marken auf der Website",placeholderManufacturers:"Marken auswählen...",buttonSave:"Speichern",buttonCancel:"Abbrechen",successSave:"Lieferant erfolgreich gespeichert",errorSave:"Fehler beim Speichern des Lieferanten",errorLoad:"Fehler beim Laden des Lieferanten",errorCreate:"Fehler beim Erstellen des Lieferanten",titleNew:"Neuer Lieferant",tabContacts:"Kontakte",tabCommercial:"Geschäftsbedingungen",tabAdditional:"Zusätzlich",tabFiles:"Dateien"}},o={artiss:l,supplier:n},p={general:{mainMenuLabel:"ARTISS"}},c={general:{mainMenuItemGeneral:"Suppliers",description:"Manage suppliers"},list:{buttonAddSupplier:"Add supplier",columnName:"Name"},detail:{cardTitleGeneral:"General information",labelName:"Name",placeholderName:"Enter supplier name...",labelManufacturers:"Brands on Website",placeholderManufacturers:"Select brands...",buttonSave:"Save",buttonCancel:"Cancel",successSave:"Supplier saved successfully",errorSave:"Error saving supplier",errorLoad:"Error loading supplier",errorCreate:"Error creating supplier",titleNew:"New supplier",tabContacts:"Contacts",tabCommercial:"Commercial Terms",tabAdditional:"Additional",tabFiles:"Files"}},u={artiss:p,supplier:c},d={general:{mainMenuLabel:"ARTISS"}},m={general:{mainMenuItemGeneral:"Поставщики",description:"Управление поставщиками"},list:{buttonAddSupplier:"Добавить поставщика",columnName:"Название"},detail:{cardTitleGeneral:"Общая информация",labelName:"Название",placeholderName:"Введите название поставщика...",labelManufacturers:"ТМ на сайте",placeholderManufacturers:"Выберите ТМ...",buttonSave:"Сохранить",buttonCancel:"Отменить",successSave:"Поставщик успешно сохранен",errorSave:"Ошибка при сохранении поставщика",errorLoad:"Ошибка при загрузке поставщика",errorCreate:"Ошибка при создании поставщика",titleNew:"Новый поставщик",tabContacts:"Контакты",tabCommercial:"Коммерческие условия",tabAdditional:"Дополнительно",tabFiles:"Файлы"}},h={artiss:d,supplier:m},f={general:{mainMenuLabel:"ARTISS"}},g={general:{mainMenuItemGeneral:"Поставщики",description:"Управление поставщиками"},list:{buttonAddSupplier:"Добавить поставщика",columnName:"Название"},detail:{cardTitleGeneral:"Общая информация",labelName:"Название",placeholderName:"Введите название поставщика...",labelManufacturers:"ТМ на сайте",placeholderManufacturers:"Выберите ТМ...",buttonSave:"Сохранить",buttonCancel:"Отменить",successSave:"Поставщик успешно сохранен",errorSave:"Ошибка при сохранении поставщика",errorLoad:"Ошибка при загрузке поставщика",errorCreate:"Ошибка при создании поставщика",titleNew:"Новый поставщик",tabContacts:"Контакты",tabCommercial:"Коммерческие условия",tabAdditional:"Дополнительно",tabFiles:"Файлы"}},b={artiss:f,supplier:g},S={general:{mainMenuLabel:"ARTISS"}},_={general:{mainMenuItemGeneral:"Постачальники",description:"Керування постачальниками"},list:{buttonAddSupplier:"Додати постачальника",columnName:"Назва"},detail:{cardTitleGeneral:"Загальна інформація",labelName:"Назва",placeholderName:"Введіть назву постачальника...",labelManufacturers:"ТМ на сайті",placeholderManufacturers:"Оберіть ТМ...",buttonSave:"Зберегти",buttonCancel:"Скасувати",successSave:"Постачальник успішно збережений",errorSave:"Помилка при збереженні постачальника",errorLoad:"Помилка при завантаженні постачальника",errorCreate:"Помилка при створенні постачальника",titleNew:"Новий постачальник",tabContacts:"Контакти",tabCommercial:"Комерційні умови",tabAdditional:"Додатково",tabFiles:"Файли"}},C={artiss:S,supplier:_},F=`{% block supplier_list %} <sw-page class="supplier-list"> {% block supplier_list_smart_bar_header %} <template #smart-bar-header> <h2> {{ $tc('supplier.general.mainMenuItemGeneral') }} </h2> </template> {% endblock %} {% block supplier_list_smart_bar_actions %} <template #smart-bar-actions> {% block supplier_list_smart_bar_actions_add %} <sw-button :routerLink="{ name: 'artiss.supplier.create' }" variant="primary" > {{ $tc('supplier.list.buttonAddSupplier') }} </sw-button> {% endblock %} </template> {% endblock %} {% block supplier_list_content %} <template #content> {% block supplier_list_content_list %} <sw-entity-listing v-if="suppliers" :items="suppliers" :repository="supplierRepository" :showSelection="false" :columns="supplierColumns" :isLoading="isLoading" :total="total" detailRoute="artiss.supplier.detail" @page-change="onPageChange" > </sw-entity-listing> {% endblock %} </template> {% endblock %} </sw-page> {% endblock %}`,{Component:w}=Shopware,{Criteria:a}=Shopware.Data;w.register("supplier-list",{template:F,inject:["repositoryFactory"],data(){return{suppliers:null,isLoading:!1,total:0,page:1,limit:25}},metaInfo(){return{title:this.$createTitle()}},computed:{supplierRepository(){return this.repositoryFactory.create("art_supplier")},supplierColumns(){return[{property:"name",dataIndex:"name",label:this.$tc("supplier.list.columnName"),routerLink:"artiss.supplier.detail",inlineEdit:"string",allowResize:!0,primary:!0}]}},created(){this.getList()},methods:{async getList(){this.isLoading=!0;const e=new a(this.page,this.limit);e.addSorting(a.sort("name","ASC"));try{const t=await this.supplierRepository.search(e);this.suppliers=t,this.total=t.total}catch(t){console.error("Error loading suppliers:",t)}finally{this.isLoading=!1}},onPageChange({page:e,limit:t}){this.page=e,this.limit=t,this.getList()}}});const y=`{% block supplier_detail %} <sw-page class="supplier-detail"> {% block supplier_detail_header %} <template #smart-bar-header> <h2>{{ identifier }}</h2> </template> {% endblock %} {% block supplier_detail_actions %} <template #smart-bar-actions> {% block supplier_detail_actions_cancel %} <sw-button :routerLink="{ name: 'artiss.supplier.index' }" :disabled="isLoading" > {{ $tc('supplier.detail.buttonCancel') }} </sw-button> {% endblock %} {% block supplier_detail_actions_save %} <sw-button-process class="supplier-detail__save-action" :isLoading="isLoading" :processSuccess="processSuccess" variant="primary" @process-finish="saveFinish" @click="onClickSave" > {{ $tc('supplier.detail.buttonSave') }} </sw-button-process> {% endblock %} </template> {% endblock %} {% block supplier_detail_content %} <template #content> <sw-card-view v-if="supplier"> {% block supplier_detail_content_card_general %} <sw-card :title="$tc('supplier.detail.cardTitleGeneral')" :isLoading="isLoading" > <sw-text-field v-model="supplier.name" :label="$tc('supplier.detail.labelName')" :placeholder="$tc('supplier.detail.placeholderName')" > </sw-text-field> <sw-multi-select :value="safeManufacturerIds" @update:value="onManufacturersChange" :label="$tc('supplier.detail.labelManufacturers')" :placeholder="$tc('supplier.detail.placeholderManufacturers')" :options="manufacturerOptions" labelProperty="label" valueProperty="value" > </sw-multi-select> </sw-card> {% endblock %} {% block supplier_detail_content_tabs %} <sw-card v-if="supplier && customFieldSets.length > 0" :isLoading="isLoading"> <sw-custom-field-set-renderer :entity="supplier" :sets="customFieldSets" /> </sw-card> {% endblock %} </sw-card-view> </template> {% endblock %} </sw-page> {% endblock %}`,{Component:L,Mixin:v}=Shopware,{Criteria:s}=Shopware.Data;console.log("[SUPPLIER-DETAIL] Registering component, timestamp:",Date.now());L.register("supplier-detail",{template:y,inject:["repositoryFactory","customFieldDataProviderService"],mixins:[v.getByName("notification")],metaInfo(){return{title:this.$createTitle(this.identifier)}},data(){return{supplier:{customFields:{}},isLoading:!1,processSuccess:!1,repository:null,customFieldSets:[],activeTab:"contacts",manufacturers:[],contactsFields:["supplier_contacts_city","supplier_contacts_phone","supplier_contacts_email","supplier_contacts_website"],commercialFields:["supplier_commercial_purchase","supplier_commercial_margin","supplier_commercial_discount_opt","supplier_commercial_discount_online"],additionalFields:["supplier_additional_details","supplier_additional_note","supplier_additional_comment_content","supplier_additional_potencial_tm"],filesFields:["supplier_files_price_lists"]}},computed:{identifier(){var e;return((e=this.supplier)==null?void 0:e.name)||this.$tc("supplier.detail.titleNew")},supplierRepository(){return this.repositoryFactory.create("art_supplier")},manufacturerRepository(){return this.repositoryFactory.create("product_manufacturer")},manufacturerOptions(){return this.manufacturers.map(e=>({value:e.id,label:e.name}))},safeManufacturerIds:{get(){return!this.supplier||!this.supplier.manufacturerIds?[]:Array.isArray(this.supplier.manufacturerIds)?this.supplier.manufacturerIds:[]},set(e){this.supplier&&(this.supplier.manufacturerIds=Array.isArray(e)?e:[])}},filteredContactsSets(){return this.filterCustomFieldSets(this.contactsFields)},filteredCommercialSets(){return this.filterCustomFieldSets(this.commercialFields)},filteredAdditionalSets(){return this.filterCustomFieldSets(this.additionalFields)},filteredFilesSets(){return this.filterCustomFieldSets(this.filesFields)},contactsFieldsWithConfig(){return this.contactsFields.map(e=>this.getCustomField(e)).filter(e=>e&&e.config)},commercialFieldsWithConfig(){return this.commercialFields.map(e=>this.getCustomField(e)).filter(e=>e&&e.config)},additionalFieldsWithConfig(){return this.additionalFields.map(e=>this.getCustomField(e)).filter(e=>e&&e.config)},filesFieldsWithConfig(){return this.filesFields.map(e=>this.getCustomField(e)).filter(e=>e&&e.config)}},created(){this.repository=this.supplierRepository,this.loadManufacturers(),this.getSupplier(),this.loadCustomFieldSets()},mounted(){this.activeTab="contacts"},watch:{activeTab(e){}},methods:{async loadManufacturers(){try{const e=new s;e.addSorting(s.sort("name","ASC")),e.setLimit(500);const t=await this.manufacturerRepository.search(e);this.manufacturers=t}catch(e){console.error("Error loading manufacturers:",e)}},async loadCustomFieldSets(){try{const e=this.repositoryFactory.create("custom_field_set"),t=new s;t.addAssociation("customFields"),t.addFilter(s.equals("name","supplier_fields"));const i=await e.search(t);this.customFieldSets=Array.from(i)}catch(e){console.error("Error loading custom field sets:",e)}},getCustomField(e){if(!this.customFieldSets||this.customFieldSets.length===0)return null;for(const t of this.customFieldSets)if(t.customFields){const i=t.customFields.find(r=>r.name===e);if(i)return i}return null},async getSupplier(){this.isLoading=!0;try{if(this.$route.params.id){const e=new s,t=await this.repository.get(this.$route.params.id,Shopware.Context.api,e);this.supplier=t}else this.supplier=this.repository.create();this.supplier.customFields||(this.supplier.customFields={}),(!this.supplier.manufacturerIds||!Array.isArray(this.supplier.manufacturerIds))&&(this.supplier.manufacturerIds=[])}catch(e){console.error("Error loading supplier:",e),this.createNotificationError({message:this.$tc("supplier.detail.errorLoad")})}finally{this.isLoading=!1}},onClickSave(){console.log("[SUPPLIER] onClickSave called, version: 2024-11-20-22:30"),this.isLoading=!0,this.processSuccess=!1;const e=!this.$route.params.id,t=this.supplier.id;return console.log("[SUPPLIER] Saving supplier:",t,"isNew:",e),this.repository.save(this.supplier,Shopware.Context.api).then(()=>{console.log("[SUPPLIER] Save successful, loading full data...");const i=new s;return this.repository.get(t,Shopware.Context.api,i)}).then(i=>{if(console.log("[SUPPLIER] Loaded full supplier:",i),this.supplier=i,this.supplier.customFields||(this.supplier.customFields={}),(!this.supplier.manufacturerIds||!Array.isArray(this.supplier.manufacturerIds))&&(this.supplier.manufacturerIds=[]),this.createNotificationSuccess({message:this.$tc("supplier.detail.successSave")}),this.isLoading=!1,this.processSuccess=!0,e)return this.$router.push({name:"artiss.supplier.detail",params:{id:t}})}).catch(i=>{console.error("Error saving supplier:",i),this.createNotificationError({message:this.$tc("supplier.detail.errorSave")}),this.isLoading=!1})},saveFinish(){this.processSuccess=!1},onManufacturersChange(e){this.supplier&&(this.supplier.manufacturerIds=Array.isArray(e)?e:[])},onTabChange(e){e&&e.name&&(this.activeTab=e.name)},filterCustomFieldSets(e){return!this.customFieldSets||this.customFieldSets.length===0?[]:this.customFieldSets.map(t=>{if(!t.customFields||t.customFields.length===0)return null;const i=t.customFields.filter(r=>e.includes(r.name));return i.length===0?null:{...t,customFields:i}}).filter(t=>t!==null)}}});const A="{% block supplier_create %} {% parent %} {% endblock %}",{Component:I}=Shopware,{Criteria:k}=Shopware.Data;console.log("[SUPPLIER-CREATE] Registering component, timestamp:",Date.now());I.extend("supplier-create","supplier-detail",{template:A,methods:{getSupplier(){this.supplier=this.repository.create()},onClickSave(){console.log("[SUPPLIER-CREATE] onClickSave called, version: 2024-11-20-22:40"),this.isLoading=!0,this.processSuccess=!1;const e=this.supplier.id;return console.log("[SUPPLIER-CREATE] Creating supplier:",e),this.repository.save(this.supplier,Shopware.Context.api).then(()=>{console.log("[SUPPLIER-CREATE] Save successful, loading full data...");const t=new k;return this.repository.get(e,Shopware.Context.api,t)}).then(t=>(console.log("[SUPPLIER-CREATE] Loaded full supplier:",t),this.supplier=t,this.supplier.customFields||(this.supplier.customFields={}),(!this.supplier.manufacturerIds||!Array.isArray(this.supplier.manufacturerIds))&&(this.supplier.manufacturerIds=[]),this.createNotificationSuccess({message:this.$tc("supplier.detail.successSave")}),this.isLoading=!1,this.processSuccess=!0,this.$router.push({name:"artiss.supplier.detail",params:{id:e}}))).catch(t=>{console.error("[SUPPLIER-CREATE] Error:",t),this.createNotificationError({message:this.$tc("supplier.detail.errorCreate")}),this.isLoading=!1})}}});const{Module:E}=Shopware;Shopware.Locale.extend("de-DE",o);Shopware.Locale.extend("en-GB",u);Shopware.Locale.extend("ru-RU",h);Shopware.Locale.extend("ru-UA",b);Shopware.Locale.extend("uk-UA",C);E.register("artiss-supplier",{type:"plugin",name:"supplier",title:"supplier.general.mainMenuItemGeneral",description:"supplier.general.description",version:"1.0.0",targetVersion:"1.0.0",color:"#ff3d58",icon:"regular-shopping-bag",entity:"art_supplier",routes:{index:{component:"supplier-list",path:"index"},detail:{component:"supplier-detail",path:"detail/:id",meta:{parentPath:"artiss.supplier.index"}},create:{component:"supplier-create",path:"create",meta:{parentPath:"artiss.supplier.index"}}},navigation:[{id:"artiss-supplier",label:"supplier.general.mainMenuItemGeneral",color:"#ff3d58",path:"artiss.supplier.index",icon:"regular-shopping-bag",parent:"sw-catalogue",position:100}]});
//# sourceMappingURL=artiss-supplier-B4ab3rvS.js.map
